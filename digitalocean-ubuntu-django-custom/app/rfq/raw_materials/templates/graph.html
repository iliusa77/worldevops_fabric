{% extends "base.html" %}

{% block title %}RM Pie Chart{% endblock %}

{% block content %}

<div class="box border primary" style="height: 700px;">
	<div class="box-title">
		<h4><i class="fa fa-adjust"></i>RM Pie Chart</h4>
		<div class="tools hidden-xs">
			<a href="javascript:;" class="collapse">
				<i class="fa fa-chevron-up"></i>
			</a>
			<a href="javascript:;" class="remove">
				<i class="fa fa-times"></i>
			</a>
		</div>
	</div>
<div class="box-body" style="overflow: hidden; display: block; height: 95%;">
   <h5>Nellore</h5>
   <div id="pie_chart" class="chart" style="padding: 0px; position: relative; height: 500px;">

    <div style="height: 500px;">

      <canvas class="flot-base" width="409" height="300" style="direction: ltr; position: absolute; left: 0px; top: 0px; width: 409px; height: 300px;"></canvas>

      <canvas class="flot-overlay" width="409" height="300" style="direction: ltr; position: absolute; left: 0px; top: 0px; width: 409px; height: 300px;"></canvas>

      </div>


      <div class="legend">
         <div style="width: 55px; top: 5px; right: 5px; opacity: 0.85; background-color: rgb(255, 255, 255);"> </div>
      </div>
   </div>
   <div id="hover" style="height:100px; width:100%; text-align:center;"></div>
</div>

</div>


<!-- BOX -->
<div class="box border primary">
    <div class="box-title">
        <h4><i class="fa fa-bar-chart-o"></i>RM Bar Chart</h4>
    </div>
    <div class="box-body">
      <div class="clearfix" style="height:50px;"></div>
        <figure class="chart" id="chart1" style="min-width:250px">
            <svg  width="100%" class="xchart"></svg>
        </figure>
    </div>
</div>
<!-- /BOX -->


<!-- BOX -->
<!-- <div class="box border primary">
    <div class="box-title">
        <h4><i class="fa fa-bar-chart-o"></i>RM Bar Chart</h4>
    </div>
    <div class="box-body">
      <div class="clearfix" id="divForGraph" style="height:50px;"></div>

    </div>
</div> -->

<!-- /BOX -->


<!-- <div class="box border primary">
  <div class="box-title">
    <h4><i class="fa fa-adjust"></i>RM Bar Chart</h4>
    <div class="tools hidden-xs">
      <a href="javascript:;" class="collapse">
        <i class="fa fa-chevron-up"></i>
      </a>
      <a href="javascript:;" class="remove">
        <i class="fa fa-times"></i>
      </a>
    </div>
  </div>
<div class="box-body" style="overflow: hidden; display: block; height: 95%;">
   <h5>Nellore</h5>


    <div class="tab-pane fade in active" id="box_tab1">

       <div id="chart-dash" class="chart"></div>
       <hr class="margin-bottom-0">

    </div>

</div>

</div> -->




{% endblock %}

{% block styles %}


{% load staticfiles %}

<!-- XCHARTS -->
<link rel="stylesheet" type="text/css" href={% static "js/xcharts/xcharts.min.css" %} />

{% endblock %}

{% block scripts %}

{% load staticfiles %}

<!-- FLOT CHARTS -->
<!-- 

<script src={% static "js/flot/jquery.flot.min.js" %}></script>
<script src={% static "js/flot/jquery.flot.time.min.js" %}></script>
<script src={% static "js/flot/jquery.flot.selection.min.js" %}></script>
<script src={% static "js/flot/jquery.flot.resize.min.js" %}></script>
<script src={% static "js/flot/jquery.flot.pie.min.js" %}></script>
<script src={% static "js/flot/jquery.flot.stack.min.js" %}></script>
<script src={% static "js/flot/jquery.flot.crosshair.min.js" %}></script>

<script src={% static "js/charts.js" %}></script>
<script src={% static "js/script.js" %}></script>
-->

<!-- D3 -->
<script type="text/javascript" src={% static "js/d3/d3.v3.min.js" %}></script>
<!-- XCHARTS -->
<script type="text/javascript" src={% static "js/xcharts/xcharts.min.js" %}></script>
<script type ="text/javascript" src="http://jqbargraph.googlecode.com/files/jqBarGraph.1.1.js"></script>

<script>

function drawgraph()
{


  //var url ='http://getprojects.in/choice/api.ashx?action=getpie&date1=2014-10-1&date2=2014-10-30'
  //$.get(url,function(data,status)
  //{
   // x= eval(data);
    
     //  alert(x[0].item);

       arrayOfData = new Array(
            [[14,54,26],'2007'],
            [[8,48,38],'2008'],
             [[4,36,57],'2009']
        ); 
    $('#divForGraph').jqBarGraph({ data: arrayOfData, title: false, barSpace: 10, width: 200,height: 200, color: '#000000', colors: false, lbl: '', 
sort: false,position: 'bottom', prefix: '', postfix: '', animate: true,legendWidth: 100, legend: true, legends: false, type: false, showValues: true, 
showValuesColor: '#fff' }); 
   

 // });
}
	jQuery(document).ready(function() {		
		//App.setPage("flot_charts");  //Set current page
		//App.init(); //Initialise plugins and elements
		
		//Charts.initCharts();
		//Charts.initPieCharts();

		var dt = {{ context_var|safe }}{% autoescape off %} {{ resp }}{% endautoescape %};
		dt = eval(dt);

		var data = [];
        var series = dt.length;
        
        for (var i = 0; i < series; i++) {
            data[i] = {
                label: dt[i].item,
                data: dt[i].value
            }
        }

		/* DEFAULT */
        $.plot($("#pie_chart"), data, {
                series: {
                    pie: {
                        show: true
                    }
                },
                legend: {
                    show: false
                },
                grid: {
                    hoverable: true,
                    clickable: true
                },
				        colors: ["#D9534F", "#A8BC7B", "#F0AD4E", "#70AFC4", "#DB5E8C", "#FCD76A", "#A696CE"]
        });

        $("#pie_chart").bind("plothover", function(event, pos, obj) {
          if (!obj) {
            return;
          }

          var percent = parseFloat(obj.series.percent).toFixed(2);
          $("#hover").html("<span style='font-weight:bold; font-size:44px; color:" + obj.series.color + "'>" + obj.series.label + " (" + percent + "%)</span>");
      });

      $("#pie_chart").bind("plotclick", function(event, pos, obj) {

        if (!obj) {
          return;
        }

        percent = parseFloat(obj.series.percent).toFixed(2);
        alert(""  + obj.series.label + ": " + percent + "%");
      });

      //chartMonth();
      //drawgraph();

	});
</script>

<script>
  jQuery(document).ready(function() {

    chart1();

    window.setTimeout(function(){
      $("rect").attr("width", "10");
    }, 1000);

  });


  function predicatBy(prop){
     return function(a,b){

      a1 = parseFloat(a.data[0].x);
      a2 = parseFloat(b.data[0].x);

      //alert(JSON.stringify(a1) + ":" + JSON.stringify(a2));

      if( a1 > a2){
        return 1;
      }else if( a1 < a2 ){
        return -1;
      }
      return 0;
    }

  }

  // function predicatBy(prop){
  //    return function(a,b){

  //     a1 = a.data[0].x;
  //     a2 = b.data[0].x;

  //     alert(JSON.stringify(a1) + ":" + JSON.stringify(a2));

  //     if( a[prop] > b[prop]){
  //       return 1;
  //     }else if( a[prop] < b[prop] ){
  //       return -1;
  //     }
  //     return 0;
  //   }

  // }

  
  //Dynamic Chart
  function chart1() {

    var tt = document.createElement('div'),
      leftOffset = -(~~$('html').css('padding-left').replace('px', '') + ~~$('body').css('margin-left').replace('px', '')),
      topOffset = -32;
    tt.className = 'ex-tooltip';
    document.body.appendChild(tt);

    var dt = {{ context_var|safe }}{% autoescape off %} {{ resp }}{% endautoescape %};
    dt = eval(dt);
    
    dt1 = [];
    d = [];
    for (i=0; i<dt.length; i++)
    {
      d =  { "className": ".class"+(i+1), "data" : [{ "y" : parseFloat(dt[i].value), "x" : ""+dt[i].item }] };
      dt1.push(d);
    }

    dt1 = dt1.sort( predicatBy("data") );

    var data = 
    {
      "xScale": "ordinal",
      "yScale": "linear",
      "comp": [],
      "main": dt1
     }; 

     var opts = {
        "axisPaddingTop" : 10,
        "dataFormatX": function (x) { return x; },
        "tickFormatX": function (x) { return x; },
        "mouseover": function (d, i) {
          var pos = $(this).offset();
          $("rect").attr("width", "10");

          $(tt).text(d.x + ': ' + d.y)
            .css({top: topOffset + pos.top, left: pos.left + leftOffset})
            .show();
        },
        "mouseout": function (x) {
          $(tt).hide();
        }
      };

    var myChart = new xChart('bar', data, '#chart1', opts);

  }
</script>



<script type="text/javascript">
  /*
    function chartMonth() { 

      // var data2 = [[0, 2.5],[1, 3.5], [2, 2], [3, 3], [4, 4],[5, 3.5], [6, 3.5], [7, 1], [8, 2], [9, 3], [10, 4],[11, 5], [12, 4], [13, 3], [14, 5], [15, 3.5],[16, 5], [17, 4], [18, 5], [19, 6],[20, 5], [21, 4], [22, 3], [23, 5], [24, 4], [25, 3],[26, 2], [27, 1], [28, 2], [29, 2],[30, 3], [31, 2]];

      var data2 = [[0, 2.5],[1, 3.5], [2, 2], [3, 3], [4, 4],[5, 3.5], [6, 3.5], [7, 1], [8, 2], [9, 3], [10, 4],[11, 5], [12, 4]];


      var dt = {{ context_var|safe }}{% autoescape off %} {{ resp }}{% endautoescape %};
      dt = eval(dt);

      for (var i = 0; i < dt.length; i++) {
        data2[i] = [dt[i].item, dt[i].value];
      };



      
      var plot = $.plot($("#chart-dash"), [{
        data: data2,
        label: "Sales",
        bars: {
          show: true,
          fill: true,
          barWidth: 0.4,
          align: "center",
          lineWidth: 13
        }
      }], {
        grid: {
          hoverable: true,
          clickable: true,
          tickColor: "#f7f7f7",
          borderWidth: 0,
          labelMargin: 10,
          margin: {
            top: 0,
            left: 5,
            bottom: 0,
            right: 0
          }
        },
        legend: {
          show: false
        },
        colors: ["rgba(109,173,189,0.5)", "#70AFC4", "#DB5E8C"],
        
        xaxis: {
          ticks: 5,
          tickDecimals: 0,
          tickColor: "#fff"
        },
        yaxis: {
          ticks: 3,
          tickDecimals: 0
        },
      });

      function showTooltip(x, y, contents) {
          $('<div id="tooltip">' + contents + '</div>').css({
                  position: 'absolute',
                  display: 'none',
                  top: y + 5,
                  left: x + 15,
                  border: '1px solid #333',
                  padding: '4px',
                  color: '#fff',
                  'border-radius': '3px',
                  'background-color': '#333',
                  opacity: 0.80
              }).appendTo("body").fadeIn(200);
      }

      var previousPoint = null;
      $("#chart-dash").bind("plothover", function (event, pos, item) {
        $("#x").text(pos.x.toFixed(2));
        $("#y").text(pos.y.toFixed(2));
        if (item) {
          if (previousPoint != item.dataIndex) {
            previousPoint = item.dataIndex;
            $("#tooltip").remove();
            var x = item.datapoint[0].toFixed(2),
              y = item.datapoint[1].toFixed(2);
            showTooltip(item.pageX, item.pageY,
              item.series.label + " of " + x + " = " + y);
          }
        } else {
          $("#tooltip").remove();
          previousPoint = null;
        }
      });
    }
    
    //Select chart
        function chart_select() {
        // setup plot
        function getData(x1, x2) {

          var d = [];
          for (var i = 0; i <= 100; ++i) {
            var x = x1 + i * (x2 - x1) / 100;
            d.push([x, Math.cos(x * Math.sin(x))]);
          }

          return [
            { label: "cos(x sin(x))", data: d }
          ];
        }

        var options = {
          grid: {
            hoverable: true,
            clickable: true,
            tickColor: "#f7f7f7",
            borderWidth: 0,
            labelMargin: 10,
            margin: {
              top: 0,
              left: 5,
              bottom: 0,
              right: 0
            }
          },
          legend: {
            show: false
          },
          series: {
            lines: {
              show: true
            },
            shadowSize: 0,
            points: {
              show: true
            }
          },
          colors: ["#D9534F"],
          yaxis: {
            ticks: 10
          },
          selection: {
            mode: "xy",
            color: "#F1ADAC"
          }
        };

        var startData = getData(0, 3 * Math.PI);

        var plot = $.plot("#placeholder", startData, options);

        // Create the overview plot

        var overview = $.plot($("#overview"), startData, {
          legend: {
            show: false
          },
          series: {
            lines: {
              show: true,
              lineWidth: 1
            },
            shadowSize: 0
          },
          xaxis: {
            ticks: 4
          },
          yaxis: {
            ticks: 3,
            min: -2,
            max: 2
          },
          colors: ["#D9534F"],
          grid: {
            color: "#999",
            borderWidth: 0,
          },
          selection: {
            mode: "xy",
            color: "#F1ADAC"
          }
        });

        // now connect the two

        $("#placeholder").bind("plotselected", function (event, ranges) {

          // clamp the zooming to prevent eternal zoom

          if (ranges.xaxis.to - ranges.xaxis.from < 0.00001) {
            ranges.xaxis.to = ranges.xaxis.from + 0.00001;
          }

          if (ranges.yaxis.to - ranges.yaxis.from < 0.00001) {
            ranges.yaxis.to = ranges.yaxis.from + 0.00001;
          }

          // do the zooming

          plot = $.plot("#placeholder", getData(ranges.xaxis.from, ranges.xaxis.to),
            $.extend(true, {}, options, {
              xaxis: { min: ranges.xaxis.from, max: ranges.xaxis.to },
              yaxis: { min: ranges.yaxis.from, max: ranges.yaxis.to }
            })
          );

          // don't fire event on the overview to prevent eternal loop

          overview.setSelection(ranges, true);
        });

        $("#overview").bind("plotselected", function (event, ranges) {
          plot.setSelection(ranges);
        });

        // Add the Flot version string to the footer

        $("#footer").prepend("Flot " + $.plot.version + " &ndash; ");

        }
    */
  
  /*-----------------------------------------------------------------------------------*/

</script>


{% endblock %}